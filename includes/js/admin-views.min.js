!function(a){var b={startFreshStatus:!1,init:function(){var c=b;c.gvStartFreshButton=a('a[href="#gv_start_fresh"]'),c.gvSelectForm=a("#gravityview_form_id"),c.currentFormId=c.gvSelectForm.val(),c.toggleInitialVisibility(c),c.gvStartFreshButton.on("click",c.startFresh),c.gvSelectForm.change(c.formChange),a('a[href="#gv_switch_view"]').on("click",c.switchView),a('a[href="#gv_select_template"]').click(c.selectTemplate),a(".gv-view-types-hover").click(c.selectTemplateHover),a('a[href="#gv_preview_template"]').click(c.previewTemplate),a("body").on("click",".gv-overlay",function(){a(".ui-dialog:visible .ui-dialog-titlebar .ui-button").click()}),a("body").on("mouseup keyup",function(b){var c=!1;"keyup"===b.type&&27==b.keyCode&&(c=!0),"mouseup"===b.type&&(!a(b.target).is(".ui-tooltip")&&!a(b.target).parents(".ui-tooltip").length>0||a(b.target).parents(".close").length>0)&&(c=!0),c&&a("a.gv-add-field[data-tooltip='active']").tooltip("close")}),a("body").on("click",".ui-tooltip-content .gv-fields",function(b){a(this).has(".field-id-all-fields").length?c.addAllFields(a(this)):c.addField(a(this),b)}),a("body").on("click",".gv-shortcode input",c.selectText),a("body").on("click","span.gv-field-controls a[href='#remove']",c.removeField),a("body").on("click","span.gv-field-controls a[href='#settings']",c.openFieldSettings),a("#gravityview_view_config").find(".hndle,.handlediv").off("click").on("click",function(a){return a.preventDefault(),!1}),a("body").on("dblclick",".gv-fields",function(a){c.openFieldSettings(a)}),a(document).on("click","#publish",c.createPresetForm)},selectText:function(b){return b.preventDefault(),a(this).focus().select(),!1},toggleInitialVisibility:function(b){""===b.currentFormId?b.hideView():a("#gravityview_directory_template").val().length>0?(a("#gravityview_select_template").slideUp(150),b.showViewConfig()):(b.templateFilter("custom"),b.showViewTypeMetabox())},hideView:function(){var c=b;c.currentFormId="",a("#gravityview_view_config, #gravityview_select_template").hide()},toggleViewTypeMetabox:function(){var b=a("#gravityview_select_template");b.is(":visible")?(a("a[href=#gv_switch_view]").text(function(){return a(this).attr("data-text-backup")}),b.slideUp(150)):(a("a[href=#gv_switch_view]").attr("data-text-backup",function(){return a(this).text()}).text(gvGlobals.label_cancel),b.slideDown(150))},showViewTypeMetabox:function(){a("#gravityview_select_template").slideDown(150)},startFresh:function(a){a.preventDefault();var c=b;c.startFreshStatus=!0,""!==c.currentFormId?c.showDialog("#gravityview_form_id_dialog"):c.startFreshContinue()},startFreshContinue:function(){var c=b;a("#gravityview_form_id_start_fresh").val("1"),a("#gravityview_form_id").val(""),a("a[href=#gv_switch_view]").hide(),c.templateFilter("preset"),c.showViewTypeMetabox(),a("#gravityview_view_config").slideUp(150)},formChange:function(c){c.preventDefault();var d=b;d.startFreshStatus=!1,""!==d.currentFormId&&d.currentFormId!==a(this).val()?d.showDialog("#gravityview_form_id_dialog"):d.formChangeContinue()},formChangeContinue:function(){var c=b;""===c.gvSelectForm.val()?c.hideView():(a("body").addClass("gv-form-changed"),c.templateFilter("custom"),c.showViewTypeMetabox(),c.getAvailableFields(),c.getSortableFields(),a("a[href=#gv_switch_view]").fadeOut(150))},showDialog:function(c,d){var e=b,f=a(c),g={text:gvGlobals.label_cancel,click:function(){f.is("#gravityview_form_id_dialog")?(e.startFreshStatus=!1,e.gvSelectForm.val(e.currentFormId)):f.is("#gravityview_switch_template_dialog")&&e.toggleViewTypeMetabox(),f.dialog("close")}},h={text:gvGlobals.label_continue,click:function(){f.is("#gravityview_form_id_dialog")?e.startFreshStatus?e.startFreshContinue():e.formChangeContinue():f.is("#gravityview_switch_template_dialog")&&(e.selectTemplateContinue(),e.toggleViewTypeMetabox()),f.dialog("close")}},i=[g,h];d=d||i,f.dialog({dialogClass:"wp-dialog",appendTo:f.parent(),draggable:!1,resizable:!1,width:function(){return a(window).width()>550?550:a(window).width()-10},open:function(){return a('<div class="gv-overlay" />').prependTo("#wpwrap"),!0},close:function(){a("#wpwrap > .gv-overlay").fadeOut("fast",function(){a(this).remove()})},closeOnEscape:!0,buttons:d})},getSortableFields:function(c,d){var e=b;a("#gravityview_sort_field").prop("disabled","disabled").empty().append("<option>"+gvGlobals.loading_text+"</option>");var f={action:"gv_sortable_fields_form",nonce:gvGlobals.nonce};void 0!==c&&"preset"===c?f.template_id=d:f.form_id=e.gvSelectForm.val(),a.post(ajaxurl,f,function(b){"false"!==b&&a("#gravityview_sort_field").empty().append(b).prop("disabled",null)})},switchView:function(a){a.preventDefault();var c=b;c.templateFilter("custom"),c.toggleViewTypeMetabox()},templateFilter:function(b){a(".gv-view-types-module").each(function(){a(this).attr("data-filter")===b?a(this).parent().show():a(this).parent().hide()})},selectTemplate:function(c){var d=b;c.preventDefault(),c.stopImmediatePropagation(),d.wantedTemplate=a(this);var e=a("#gravityview_directory_template").val(),f=d.wantedTemplate.attr("data-templateid");""===e?(a("#gravityview_select_template").slideUp(150),d.selectTemplateContinue()):e!=f?d.showDialog("#gravityview_switch_template_dialog"):(a("#gravityview_select_template").slideUp(150),a("#gravityview_view_config").slideDown(150))},selectTemplateContinue:function(){var c=b,d=c.wantedTemplate.attr("data-templateid");a("#gravityview_directory_template").val(d).change();var e=c.wantedTemplate.parents(".gv-view-types-module");e.parents(".gv-grid").find(".gv-view-types-module").removeClass("gv-selected"),e.addClass("gv-selected"),c.startFreshStatus?(c.getAvailableFields("preset",d),c.getPresetFields(d),c.getSortableFields("preset",d)):(c.updateActiveAreas(d),a("a[href=#gv_switch_view]").fadeIn(150),c.toggleViewTypeMetabox())},selectTemplateHover:function(b){b.preventDefault(),b.stopImmediatePropagation(),a(this).find('a[href="#gv_select_template"]').trigger("click")},previewTemplate:function(b){b.preventDefault(),b.stopImmediatePropagation();var c=a(event.currentTarget).parents(".gv-view-types-module");c.find(".gv-template-preview").dialog({dialogClass:"wp-dialog",appendTo:a("#gravityview_select_template"),width:550,open:function(){a('<div class="gv-overlay" />').prependTo("#wpwrap")},close:function(){a("#wpwrap > .gv-overlay").fadeOut("fast",function(){a(this).remove()})},closeOnEscape:!0,buttons:[{text:gvGlobals.label_close,click:function(){a(this).dialog("close")}}],close:function(){a(this).dialog("option","appendTo",c)}})},updateActiveAreas:function(c){var d=b;a("#directory-active-fields, #single-active-fields").children().remove();var e={action:"gv_get_active_areas",template_id:c,nonce:gvGlobals.nonce};a.post(ajaxurl,e,function(b){if(b){var c=a.parseJSON(b);a("#directory-header-widgets").html(c.header),a("#directory-footer-widgets").html(c.footer),a("#directory-active-fields").append(c.directory),a("#single-active-fields").append(c.single),d.showViewConfig()}})},getPresetFields:function(c){var d=b;a("#directory-active-fields, #single-active-fields").children().remove();var e={action:"gv_get_preset_fields",template_id:c,nonce:gvGlobals.nonce};a.post(ajaxurl,e,function(b){if(b){var c=a.parseJSON(b);a("#directory-header-widgets").html(c.header),a("#directory-footer-widgets").html(c.footer),a("#directory-active-fields").append(c.directory),a("#single-active-fields").append(c.single),d.showViewConfig()}})},showViewConfig:function(){var c=b;a("#gravityview_view_config").slideDown(150),c.toggleDropMessage(),c.init_droppables(),c.init_tooltips()},init_tooltips:function(){a(".gv-add-field").tooltip({content:function(){var b=a(this).attr("data-objecttype");return"field"===b?a("#directory-available-fields").html():"widget"===b?a("#directory-available-widgets").html():void 0},close:function(){a(this).attr("data-tooltip","")},open:function(){a(this).attr("data-tooltip","active").attr("data-tooltip-id",a(this).attr("aria-describedby"))},closeOnEscape:!0,disabled:!0,position:{my:"center bottom",at:"center top-12"},tooltipClass:"top"}).on("mouseout focusout",function(a){a.stopImmediatePropagation()}).click(function(b){b.preventDefault(),b.stopImmediatePropagation(),a(this).tooltip("open"),a(this).attr("title","")})},getAvailableFields:function(c,d){var e=b;a("#directory-available-fields, #single-available-fields").find(".gv-fields").remove(),a("#directory-active-fields, #single-active-fields").find(".gv-fields").remove(),e.toggleDropMessage();var f={action:"gv_available_fields",nonce:gvGlobals.nonce};void 0!==c&&"preset"===c?f.template_id=d:f.form_id=e.gvSelectForm.val(),a.post(ajaxurl,f,function(b){b&&(a("#directory-available-fields").append(b),a("#single-available-fields").append(b))})},addAllFields:function(b){b.siblings(".gv-fields").each(function(){a(this).trigger("click")}),a("a.gv-add-field[data-tooltip='active']").tooltip("close")},addField:function(c,d){d.preventDefault();var e=b,f=c.clone().hide(),g=c.parents(".ui-tooltip").attr("id"),h=a("#gravityview_directory_template").val(),i=c.parents(".ui-tooltip").attr("id"),j=a('a.gv-add-field[data-tooltip-id="'+i+'"]'),k={action:"gv_field_options",template:h,area:j.attr("data-areaid"),context:j.attr("data-context"),field_id:f.attr("data-fieldid"),field_label:f.find("h5").text(),field_type:j.attr("data-objecttype"),input_type:f.attr("data-inputtype"),nonce:gvGlobals.nonce};a.post(ajaxurl,k,function(b){b&&(f.append(b),a(".all-merge-tags").remove(),"undefined"!=typeof form&&a("body").not(".gv-form-changed")&&(window.gfMergeTags=new gfMergeTagsObj(form)),a(".gv-dialog-options",f).length>0&&a(".dashicons-admin-generic",f).hide().removeClass("hide-if-js").fadeIn(100))}),a('a[data-tooltip-id="'+g+'"]').parents(".gv-droppable-area").find(".active-drop").append(f).end().attr("data-tooltip-id",""),f.fadeIn("fast"),f.siblings(".gv-fields").length>0&&(tooltipOffset=a("#"+i).offset(),a("#"+i).offset({top:tooltipOffset.top+f.outerHeight()+5})),e.toggleDropMessage()},init_droppables:function(){var c=b;a("#directory-fields, #single-fields").find(".active-drop-widget").sortable({placeholder:"fields-placeholder",items:"> .gv-fields",distance:2,revert:75,connectWith:".active-drop-widget",receive:function(b,d){var e=d.sender.attr("data-areaid"),f=a(this).attr("data-areaid");d.item.find('[name^="widgets['+e+']"]').each(function(){var b=a(this).attr("name");a(this).attr("name",b.replace(e,f))}),c.toggleDropMessage()}}),a("#directory-fields, #single-fields").find(".active-drop-field").sortable({placeholder:"fields-placeholder",items:"> .gv-fields",distance:2,revert:75,connectWith:".active-drop-field",receive:function(b,d){if(d.item.find(".gv-dialog-options").length>0){var e=d.sender.attr("data-areaid"),f=a(this).attr("data-areaid");d.item.find('[name^="fields['+e+']"]').each(function(){var b=a(this).attr("name");a(this).attr("name",b.replace(e,f))})}c.toggleDropMessage()}})},toggleDropMessage:function(){a(".active-drop").each(function(){a(this).find(".gv-fields").length>0?a(this).find(".drop-message").hide():a(this).find(".drop-message").fadeIn(100)})},removeField:function(c){var d=b;c.preventDefault();a(c.currentTarget).parents(".active-drop");a(c.currentTarget).parents(".gv-fields").fadeOut("normal",function(){a(this).remove(),d.toggleDropMessage()})},openFieldSettings:function(c){c.preventDefault();var d,e=b;d=a(c.currentTarget).is(".gv-fields")?a(c.currentTarget):a(c.currentTarget).parents(".gv-fields"),e.updateVisibilitySettings(c,!0),a("body").on("change",".gv-fields input:checkbox",e.updateVisibilitySettings);var f=[{text:gvGlobals.label_close,click:function(){a(this).dialog("close")}}];e.showDialog(d.find(".gv-dialog-options"),f)},updateVisibilitySettings:function(c,d){var e=b;d=d||!1,$parent=a(c.currentTarget).is(".gv-fields")?a(c.currentTarget):a(c.currentTarget).parents(".gv-fields"),e.toggleVisibility(a("input:checkbox[name*=show_label]",$parent),a("[name*=custom_label]",$parent),d),a("input:checkbox",$parent).attr("disabled",null),a("input:checkbox[name*=show_as_link]",$parent).is(":checked")&&a("input:checkbox[name*=link_to_]",$parent).attr("disabled",!0),a("input:checkbox[name*=link_to_]:checked",$parent).length>0&&a("input:checkbox[name*=show_as_link]",$parent).attr("disabled",!0),e.toggleVisibility(a("input:checkbox[name*=only_loggedin]",$parent),a("[name*=only_loggedin_cap]",$parent),d)},toggleVisibility:function(a,b,c){var d=c?0:"fast";a.is(":checked")?b.parents("li").fadeIn(d):b.parents("li").fadeOut(d)},createPresetForm:function(){var c=b,d=a("#gravityview_directory_template").val();if(!c.startFreshStatus||""===d)return!0;var e={action:"gv_set_preset_form",template_id:d,nonce:gvGlobals.nonce};return a.post(ajaxurl,e,function(b){"false"!=b?(c.startFreshStatus=!1,c.gvSelectForm.find("option:selected").removeAttr("selected"),c.gvSelectForm.append(b),a("#publish").trigger("click")):a("#post").before('<div id="message" class="error below-h2"><p>'+gvGlobals.label_publisherror+"</p></div>")}),!1}};a(document).ready(function(){a("#title-prompt-text").text(gvGlobals.label_viewname),b.init(),a(".gv-datepicker").datepicker({dateFormat:"yy-mm-dd",constrainInput:!1});var c="gv-active-tab-"+a("#post_ID").val(),d=a.cookie(c);"undefined"===d&&(d=0),a("#gv-view-configuration-tabs").tabs({active:d,activate:function(b,d){a.cookie(c,d.newTab.index(),{path:gvGlobals.cookiepath})}}),a("#gravityview_template_settings .form-table tr:even").addClass("alternate")})}(jQuery),!function(a){var b={startFreshStatus:!1,init:function(){var c=b;c.gvStartFreshButton=a('a[href="#gv_start_fresh"]'),c.gvSelectForm=a("#gravityview_form_id"),c.currentFormId=c.gvSelectForm.val(),c.toggleInitialVisibility(c),c.gvStartFreshButton.on("click",c.startFresh),c.gvSelectForm.change(c.formChange),a('a[href="#gv_switch_view"]').on("click",c.switchView),a('a[href="#gv_select_template"]').click(c.selectTemplate),a(".gv-view-types-hover").click(c.selectTemplateHover),a('a[href="#gv_preview_template"]').click(c.previewTemplate),a("body").on("click",".gv-overlay",function(){a(".ui-dialog:visible .ui-dialog-titlebar .ui-button").click()}),a("body").on("mouseup keyup",function(b){var c=!1;"keyup"===b.type&&27==b.keyCode&&(c=!0),"mouseup"===b.type&&(!a(b.target).is(".ui-tooltip")&&!a(b.target).parents(".ui-tooltip").length>0||a(b.target).parents(".close").length>0)&&(c=!0),c&&a("a.gv-add-field[data-tooltip='active']").tooltip("close")}),a("body").on("click",".ui-tooltip-content .gv-fields",function(b){a(this).has(".field-id-all-fields").length?c.addAllFields(a(this)):c.addField(a(this),b)}),a("body").on("click",".gv-shortcode input",c.selectText),a("body").on("click","span.gv-field-controls a[href='#remove']",c.removeField),a("body").on("click","span.gv-field-controls a[href='#settings']",c.openFieldSettings),a("#gravityview_view_config").find(".hndle,.handlediv").off("click").on("click",function(a){return a.preventDefault(),!1}),a("body").on("dblclick",".gv-fields",function(a){c.openFieldSettings(a)}),a(document).on("click","#publish",c.createPresetForm)},selectText:function(b){return b.preventDefault(),a(this).focus().select(),!1},toggleInitialVisibility:function(b){""===b.currentFormId?b.hideView():a("#gravityview_directory_template").val().length>0?(a("#gravityview_select_template").slideUp(150),b.showViewConfig()):(b.templateFilter("custom"),b.showViewTypeMetabox())},hideView:function(){var c=b;c.currentFormId="",a("#gravityview_view_config, #gravityview_select_template").hide()},toggleViewTypeMetabox:function(){var b=a("#gravityview_select_template");b.is(":visible")?(a("a[href=#gv_switch_view]").text(function(){return a(this).attr("data-text-backup")}),b.slideUp(150)):(a("a[href=#gv_switch_view]").attr("data-text-backup",function(){return a(this).text()}).text(gvGlobals.label_cancel),b.slideDown(150))},showViewTypeMetabox:function(){a("#gravityview_select_template").slideDown(150)},startFresh:function(a){a.preventDefault();var c=b;c.startFreshStatus=!0,""!==c.currentFormId?c.showDialog("#gravityview_form_id_dialog"):c.startFreshContinue()},startFreshContinue:function(){var c=b;a("#gravityview_form_id_start_fresh").val("1"),a("#gravityview_form_id").val(""),a("a[href=#gv_switch_view]").hide(),c.templateFilter("preset"),c.showViewTypeMetabox(),a("#gravityview_view_config").slideUp(150)},formChange:function(c){c.preventDefault();var d=b;d.startFreshStatus=!1,""!==d.currentFormId&&d.currentFormId!==a(this).val()?d.showDialog("#gravityview_form_id_dialog"):d.formChangeContinue()},formChangeContinue:function(){var c=b;""===c.gvSelectForm.val()?c.hideView():(a("body").addClass("gv-form-changed"),c.templateFilter("custom"),c.showViewTypeMetabox(),c.getAvailableFields(),c.getSortableFields(),a("a[href=#gv_switch_view]").fadeOut(150))},showDialog:function(c,d){var e=b,f=a(c),g={text:gvGlobals.label_cancel,click:function(){f.is("#gravityview_form_id_dialog")?(e.startFreshStatus=!1,e.gvSelectForm.val(e.currentFormId)):f.is("#gravityview_switch_template_dialog")&&e.toggleViewTypeMetabox(),f.dialog("close")}},h={text:gvGlobals.label_continue,click:function(){f.is("#gravityview_form_id_dialog")?e.startFreshStatus?e.startFreshContinue():e.formChangeContinue():f.is("#gravityview_switch_template_dialog")&&(e.selectTemplateContinue(),e.toggleViewTypeMetabox()),f.dialog("close")}},i=[g,h];d=d||i,f.dialog({dialogClass:"wp-dialog",appendTo:f.parent(),draggable:!1,resizable:!1,width:function(){return a(window).width()>550?550:a(window).width()-10},open:function(){return a('<div class="gv-overlay" />').prependTo("#wpwrap"),!0},close:function(){a("#wpwrap > .gv-overlay").fadeOut("fast",function(){a(this).remove()})},closeOnEscape:!0,buttons:d})},getSortableFields:function(c,d){var e=b;a("#gravityview_sort_field").prop("disabled","disabled").empty().append("<option>"+gvGlobals.loading_text+"</option>");var f={action:"gv_sortable_fields_form",nonce:gvGlobals.nonce};void 0!==c&&"preset"===c?f.template_id=d:f.form_id=e.gvSelectForm.val(),a.post(ajaxurl,f,function(b){"false"!==b&&a("#gravityview_sort_field").empty().append(b).prop("disabled",null)})},switchView:function(a){a.preventDefault();var c=b;c.templateFilter("custom"),c.toggleViewTypeMetabox()},templateFilter:function(b){a(".gv-view-types-module").each(function(){a(this).attr("data-filter")===b?a(this).parent().show():a(this).parent().hide()})},selectTemplate:function(c){var d=b;c.preventDefault(),c.stopImmediatePropagation(),d.wantedTemplate=a(this);var e=a("#gravityview_directory_template").val(),f=d.wantedTemplate.attr("data-templateid");""===e?(a("#gravityview_select_template").slideUp(150),d.selectTemplateContinue()):e!=f&&d.showDialog("#gravityview_switch_template_dialog")},selectTemplateContinue:function(){var c=b,d=c.wantedTemplate.attr("data-templateid");a("#gravityview_directory_template").val(d).change();var e=c.wantedTemplate.parents(".gv-view-types-module");e.parents(".gv-grid").find(".gv-view-types-module").removeClass("gv-selected"),e.addClass("gv-selected"),c.startFreshStatus?(c.getAvailableFields("preset",d),c.getPresetFields(d),c.getSortableFields("preset",d)):(c.updateActiveAreas(d),a("a[href=#gv_switch_view]").fadeIn(150),c.toggleViewTypeMetabox())},selectTemplateHover:function(b){b.preventDefault(),b.stopImmediatePropagation(),a(this).find('a[href="#gv_select_template"]').trigger("click")},previewTemplate:function(b){b.preventDefault(),b.stopImmediatePropagation();var c=a(event.currentTarget).parents(".gv-view-types-module");c.find(".gv-template-preview").dialog({dialogClass:"wp-dialog",appendTo:a("#gravityview_select_template"),width:550,open:function(){a('<div class="gv-overlay" />').prependTo("#wpwrap")},close:function(){a("#wpwrap > .gv-overlay").fadeOut("fast",function(){a(this).remove()})},closeOnEscape:!0,buttons:[{text:gvGlobals.label_close,click:function(){a(this).dialog("close")}}],close:function(){a(this).dialog("option","appendTo",c)}})},updateActiveAreas:function(c){var d=b;a("#directory-active-fields, #single-active-fields").children().remove();var e={action:"gv_get_active_areas",template_id:c,nonce:gvGlobals.nonce};a.post(ajaxurl,e,function(b){if(b){var c=a.parseJSON(b);a("#directory-header-widgets").html(c.header),a("#directory-footer-widgets").html(c.footer),a("#directory-active-fields").append(c.directory),a("#single-active-fields").append(c.single),d.showViewConfig()}})},getPresetFields:function(c){var d=b;a("#directory-active-fields, #single-active-fields").children().remove();var e={action:"gv_get_preset_fields",template_id:c,nonce:gvGlobals.nonce};a.post(ajaxurl,e,function(b){if(b){var c=a.parseJSON(b);a("#directory-header-widgets").html(c.header),a("#directory-footer-widgets").html(c.footer),a("#directory-active-fields").append(c.directory),a("#single-active-fields").append(c.single),d.showViewConfig()}})},showViewConfig:function(){var c=b;a("#gravityview_view_config").slideDown(150),c.toggleDropMessage(),c.init_droppables(),c.init_tooltips()},init_tooltips:function(){a(".gv-add-field").tooltip({content:function(){var b=a(this).attr("data-objecttype");return"field"===b?a("#directory-available-fields").html():"widget"===b?a("#directory-available-widgets").html():void 0},close:function(){a(this).attr("data-tooltip","")},open:function(){a(this).attr("data-tooltip","active").attr("data-tooltip-id",a(this).attr("aria-describedby"))},closeOnEscape:!0,disabled:!0,position:{my:"center bottom",at:"center top-12"},tooltipClass:"top"}).on("mouseout focusout",function(a){a.stopImmediatePropagation()}).click(function(b){b.preventDefault(),b.stopImmediatePropagation(),a(this).tooltip("open"),a(this).attr("title","")})},getAvailableFields:function(c,d){var e=b;a("#directory-available-fields, #single-available-fields").find(".gv-fields").remove(),a("#directory-active-fields, #single-active-fields").find(".gv-fields").remove(),e.toggleDropMessage();var f={action:"gv_available_fields",nonce:gvGlobals.nonce};void 0!==c&&"preset"===c?f.template_id=d:f.form_id=e.gvSelectForm.val(),a.post(ajaxurl,f,function(b){b&&(a("#directory-available-fields").append(b),a("#single-available-fields").append(b))})},addAllFields:function(b){b.siblings(".gv-fields").each(function(){a(this).trigger("click")}),a("a.gv-add-field[data-tooltip='active']").tooltip("close")},addField:function(c,d){d.preventDefault();var e=b,f=c.clone().hide(),g=c.parents(".ui-tooltip").attr("id"),h=a("#gravityview_directory_template").val(),i=c.parents(".ui-tooltip").attr("id"),j=a('a.gv-add-field[data-tooltip-id="'+i+'"]'),k={action:"gv_field_options",template:h,area:j.attr("data-areaid"),context:j.attr("data-context"),field_id:f.attr("data-fieldid"),field_label:f.find("h5").text(),field_type:j.attr("data-objecttype"),input_type:f.attr("data-inputtype"),nonce:gvGlobals.nonce};a.post(ajaxurl,k,function(b){b&&(f.append(b),a(".all-merge-tags").remove(),"undefined"!=typeof form&&a("body").not(".gv-form-changed")&&(window.gfMergeTags=new gfMergeTagsObj(form)),a(".gv-dialog-options",f).length>0&&a(".dashicons-admin-generic",f).hide().removeClass("hide-if-js").fadeIn(100))}),a('a[data-tooltip-id="'+g+'"]').parents(".gv-droppable-area").find(".active-drop").append(f).end().attr("data-tooltip-id",""),f.fadeIn("fast"),f.siblings(".gv-fields").length>0&&(tooltipOffset=a("#"+i).offset(),a("#"+i).offset({top:tooltipOffset.top+f.outerHeight()+5})),e.toggleDropMessage()},init_droppables:function(){var c=b;a("#directory-fields, #single-fields").find(".active-drop-widget").sortable({placeholder:"fields-placeholder",items:"> .gv-fields",distance:2,revert:75,connectWith:".active-drop-widget",receive:function(b,d){var e=d.sender.attr("data-areaid"),f=a(this).attr("data-areaid");d.item.find('[name^="widgets['+e+']"]').each(function(){var b=a(this).attr("name");a(this).attr("name",b.replace(e,f))}),c.toggleDropMessage()}}),a("#directory-fields, #single-fields").find(".active-drop-field").sortable({placeholder:"fields-placeholder",items:"> .gv-fields",distance:2,revert:75,connectWith:".active-drop-field",receive:function(b,d){if(d.item.find(".gv-dialog-options").length>0){var e=d.sender.attr("data-areaid"),f=a(this).attr("data-areaid");d.item.find('[name^="fields['+e+']"]').each(function(){var b=a(this).attr("name");a(this).attr("name",b.replace(e,f))})}c.toggleDropMessage()}})},toggleDropMessage:function(){a(".active-drop").each(function(){a(this).find(".gv-fields").length>0?a(this).find(".drop-message").hide():a(this).find(".drop-message").fadeIn(100)})},removeField:function(c){var d=b;c.preventDefault();a(c.currentTarget).parents(".active-drop");a(c.currentTarget).parents(".gv-fields").fadeOut("normal",function(){a(this).remove(),d.toggleDropMessage()})},openFieldSettings:function(c){c.preventDefault();var d,e=b;d=a(c.currentTarget).is(".gv-fields")?a(c.currentTarget):a(c.currentTarget).parents(".gv-fields"),e.updateVisibilitySettings(c,!0),a("body").on("change",".gv-fields input:checkbox",e.updateVisibilitySettings);var f=[{text:gvGlobals.label_close,click:function(){a(this).dialog("close")}}];e.showDialog(d.find(".gv-dialog-options"),f)},updateVisibilitySettings:function(c,d){var e=b;d=d||!1,$parent=a(c.currentTarget).is(".gv-fields")?a(c.currentTarget):a(c.currentTarget).parents(".gv-fields"),e.toggleVisibility(a("input:checkbox[name*=show_label]",$parent),a("[name*=custom_label]",$parent),d),a("input:checkbox",$parent).attr("disabled",null),a("input:checkbox[name*=show_as_link]",$parent).is(":checked")&&a("input:checkbox[name*=link_to_]",$parent).attr("disabled",!0),a("input:checkbox[name*=link_to_]:checked",$parent).length>0&&a("input:checkbox[name*=show_as_link]",$parent).attr("disabled",!0),e.toggleVisibility(a("input:checkbox[name*=only_loggedin]",$parent),a("[name*=only_loggedin_cap]",$parent),d)},toggleVisibility:function(a,b,c){var d=c?0:"fast";a.is(":checked")?b.parents("li").fadeIn(d):b.parents("li").fadeOut(d)},createPresetForm:function(){var c=b,d=a("#gravityview_directory_template").val();if(!c.startFreshStatus||""===d)return!0;var e={action:"gv_set_preset_form",template_id:d,nonce:gvGlobals.nonce};return a.post(ajaxurl,e,function(b){"false"!=b?(c.startFreshStatus=!1,c.gvSelectForm.find("option:selected").removeAttr("selected"),c.gvSelectForm.append(b),a("#publish").trigger("click")):a("#post").before('<div id="message" class="error below-h2"><p>'+gvGlobals.label_publisherror+"</p></div>")}),!1}};a(document).ready(function(){a("#title-prompt-text").text(gvGlobals.label_viewname),b.init(),a(".gv-datepicker").datepicker({dateFormat:"yy-mm-dd",constrainInput:!1});var c="gv-active-tab-"+a("#post_ID").val(),d=a.cookie(c);"undefined"===d&&(d=0),a("#gv-view-configuration-tabs").tabs({active:d,activate:function(b,d){a.cookie(c,d.newTab.index(),{path:gvGlobals.cookiepath})}}),a("#gravityview_template_settings .form-table tr:even").addClass("alternate")})}(jQuery);